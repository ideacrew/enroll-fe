<ng-container *transloco="let t">
  <div class="person" *ngIf="person$ | async as person; else loadingPerson">
    <h1 class="person-header">{{ person.person_name.full_name }}</h1>

    <div *ngFor="let member of person.members" class="member-information">
      <div class="member-information-header">
        <h2>Personal Info</h2>
        <dl>
          <dt>HBX Member ID</dt>
          <dd>{{ member.hbx_member_id }}</dd>
          <dt>Gender</dt>
          <!-- This translation is coming from the generic translations -->
          <dd>{{ t(member.gender) | titlecase }}</dd>
          <dt>DOB</dt>
          <dd>{{ member.dob | date : 'MM/dd/YYYY' }}</dd>
          <dt>SSN</dt>
          <dd>{{ member.ssn | formatSsn }}</dd>
        </dl>

        <h2>Contact Info</h2>
        <dl>
          <dt>Mailing Address</dt>
          <dd>{{ fullAddress(member.mailing_address) }}</dd>
          <dt>Home Address</dt>
          <dd>{{ fullAddress(member.home_address) }}</dd>
          <dt>Home Email</dt>
          <dd>{{ member.home_email }}</dd>
          <dt>Mobile Phone</dt>
          <dd>{{ member.mobile_phone }}</dd>
        </dl>

        <h2>Policies</h2>
        <details
          [open]="policy.status === 'Submitted'"
          class="policy-summary"
          *ngFor="let policy of member.policies | sortByStatus : 'Submitted'"
        >
          <summary>
            <ng-container
              *ngIf="
                policy.plan.product_kind === 'health';
                then healthPolicyIcon;
                else dentalPolicyIcon
              "
            ></ng-container>
            <span>{{ policy.status }}</span>
            <span>{{ policy.rating_area }}</span>
            <span>{{ policy.plan.name }}</span>
          </summary>
          <enroll-member-policy [policy]="policy"></enroll-member-policy>
        </details>
      </div>
    </div>

    <!-- Need to evaluate what this is, how to display -->
    <!-- <div
      *ngFor="let responsibleParty of person.responsible_parties"
      class="member-information"
    >
      <div class="member-information-header">
        <h2>Responsible Party ID: {{ responsibleParty.id }}</h2>
      </div>
      <enroll-member-policy
        *ngFor="let policy of responsibleParty.policies"
        [policy]="policy"
      >
      </enroll-member-policy>
    </div> -->
  </div>

  <ng-template #loadingPerson>
    <p>Loading...</p>
  </ng-template>

  <ng-template #healthPolicyIcon
    ><img class="header-icon" src="../../assets/images/health_policy.svg"
  /></ng-template>
  <ng-template #dentalPolicyIcon
    ><img class="header-icon" src="../../assets/images/dental_policy.svg"
  /></ng-template>
</ng-container>
